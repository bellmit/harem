<link rel="stylesheet" href="$utilWebconfig.getStaticResourcesPath()/resources/css/common.css"/>
<link rel="stylesheet" href="$utilWebconfig.getStaticResourcesPath()/resources/css/clubTable.css"/>
<script src="$utilWebconfig.getStaticResourcesPath()/resources/js/ajaxfileupload.js" type="text/javascript"></script>

<link href="$utilWebconfig.getStaticResourcesPath()/resources/zui/lib/datetimepicker/datetimepicker.min.css" rel="stylesheet">
<script src="$utilWebconfig.getStaticResourcesPath()/resources/zui/lib/datetimepicker/datetimepicker.min.js" type="text/javascript"></script>

<div class="createClubTable whole">
    <form name="addClub" id="clubForm" action="" method="post" clubId="$!travelOfficial.id">
<!--tab1 -->
        <table class="table">
            <tr>
                <td><span class="spColor">*</span>游记标题</td>
              
                <td><input type="text" class="form-control" placeholder="请输入20个字以内" name="title" value="$!travelOfficial.title"></td>
            </tr>
            <tr>
                <td><span class="spColor">*</span>发布时间</td>
                <td> <input type="text" class='form-control form-date dateInp' placeholder='' readonly name="publishDate" value="$!travelOfficial.publishDate"></td>
            </tr>
			#*
				<tr>
               		<td><span class="spColor">*</span>目的地</td>
                	<td><input type="text" class="form-control" placeholder="请输入数字，数字越大排序靠后" name="sequenceNum" value="$!travelOfficial.sequenceNum"></td>
            	</tr>
			*#

            <tr>
                <td><span class="spColor">*</span>作者信息</td>
                <td>
                    <div class="userBtn">
                        <button type="button" class="btn btn-info selectUserBtn">选择用户</button>
                        <input type="hidden" name="manageUserName" value="$!travelOfficial.manageUserName">
                        <input type="hidden" name="manageUserLogoUrl" value="$!travelOfficial.manageUserLogoUrl">
                    </div>
                    <div class="userView">
                        <img src=" #if($club.manageUserLogoUrl) $utilWebconfig.getTfsRootPath()$!travelOfficial.manageUserLogoUrl  #end">
                        <span>Tracy</span>
                    </div>
                </td>
			</tr>
			
			<tr>
                <td><span class="spColor">*</span>游记封面</td>
                <td>
					<div >
                        <p><img src="$!travelOfficial.backImg"></p>
					</div>
                </td>
            </tr>
	        <tr>
                <td><span class="spColor">*</span>点赞数</td>
                <td class="radioSel">
                    <div class="col-md-10">
                        <input type="text" class="form-control"  name="praiseNum" value="$!travelOfficial.praiseNum">
                    </div> 
                </td>
            </tr>
            <tr>
                <td><span class="spColor">*</span>浏览量</td>
                <td class="radioSel">
                    <div class="col-md-10">
                        <input type="text" class="form-control"  name="pv" value="$!travelOfficial.pv">
                    </div>
                </td>
            </tr>
        </table>
        <!--tab1 -->
		
    </form>
</div>

<script>

    $(".form-date").datetimepicker(
            {
                language:  "zh-CN",
                weekStart: 1,
                todayBtn:  1,
                autoclose: 1,
                todayHighlight: 1,
                startView: 2,
                minView: 2,
                forceParse: 0,
                format: "yyyy-mm-dd"
            });


    $(function(){
        $(document).delegate('#logoUrlUploadFile','change',function(){
            $.ajaxFileUpload
            (
                    {
                        url: '/upload/file', //用于文件上传的服务器端请求地址
                        secureuri: false, //是否需要安全协议，一般设置为false
                        fileElementId: 'logoUrlUploadFile', //文件上传域的ID
                        dataType: 'json', //返回值类型 一般设置为json
                        success: function (data,status)  //服务器成功响应处理函数
                        {
                            if(data && data.status==200){
                                var tfsPath = '$utilWebconfig.getTfsRootPath()';
                                $('#logoUrlUploadFileReturnInput').val(data.data);
                                $('#logoUrlUploadFileReturnImg').attr('src',tfsPath + data.data);

                            }else{
                                layer.alert('上传失败');
                            }
                        },
                        error: function (data)//服务器响应失败处理函数
                        {
                            layer.alert('服务器异常');
                        }
                    }
            )
        });

        $(document).delegate('#picturePosterUploadFile','change',function(){
            $.ajaxFileUpload
            (
                    {
                        url: '/upload/file', //用于文件上传的服务器端请求地址
                        secureuri: false, //是否需要安全协议，一般设置为false
                        fileElementId: 'picturePosterUploadFile', //文件上传域的ID
                        dataType: 'json', //返回值类型 一般设置为json
                        success: function (data,status)  //服务器成功响应处理函数
                        {
                            if(data && data.status==200){
                                var tfsPath = '$utilWebconfig.getTfsRootPath()';
                                $('#picturePosterUploadFileReturnInput').val(data.data);
                                $('#picturePosterUploadFileReturnImg').attr('src',tfsPath + data.data);

                            }else{
                                layer.alert('上传失败');
                            }
                        },
                        error: function (data)//服务器响应失败处理函数
                        {
                            layer.alert('服务器异常');
                        }
                    }
            )
        });
        $('#btnSubmit').click(function(){
            $(this).prop('disabled',true);
            var actionUrl;
            var clubId = $('#clubForm').attr('clubId');
            if(clubId){
                actionUrl = '/B2C/travelOfficialManage/edit';
            }else{
                actionUrl = '/B2C/travelOfficialManage/add';
            }
            $('#clubForm').attr('action',actionUrl);
            $.post(actionUrl,$('#clubForm').serialize(),function(data){
                if(data.status == 200){
                   layer.alert('操作成功');
                }else{
                 	layer.alert('操作失败');
                    $(this).prop('disabled',false);
                }
            });
        });
    });
    
    //选择用户
     $('.selectUserBtn').click(function(){
            '$!utilWebconfig.getActionDefaultFontPath()',
                    openModal(actionDefaultPath + '/B2C/resourceForSelect/selectOneUser', "选择用户", selectUserCallBack)
     });
     
     
</script>