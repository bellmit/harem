<script src="$!{staticResourcesPath}/resources/js/layerModal.js" type="text/javascript"></script><div>
<div>
	<div >
        <div>
    		<div>线路明细</div>
        	<table>
        		<tr >
    				<td>*产品类型：</td>
    				<td>跟团游<input type="hidden" class="productType" value="1"/></td>
                </tr>
    			<tr >
    				<td>*产品名称：</td>
    				<td><input type="text" class="form-control" placeholder="请输入产品名称" name="productName" value="$!product.name"></td>
                </tr>
    			<tr >
    				<td>*产品封面图：</td>
    				<td>
                        <span><button class="btn btn-default">请选择图片</button>图片大小不超过5M，背景图尺寸为：750x420和600*800</span>
                        <span><input type="hidden" class="productImage" value="$!product.roductImage"/></span>
					</td>
                </tr>
				<tr >
    				<td>*行程封面图：</td>
    				<td>
                        <span><button class="btn btn-default">请选择图片</button>图片大小不超过5M，背景图尺寸为：750x420和600*800</span>
                        <span><input type="hidden" class="tripImage" value="$!product.tripImage"/></span>
					</td>
                </tr>
    			<tr >
    				<td>*产品主题：</td>
                    <td>
						<input type="checkbox" class="productTheme" rId="0" rName="热门推荐" id="theme0"/><label for="theme0">热门推荐</label>
						<input type="checkbox" class="productTheme" rId="1" rName="热门推荐" id="theme1"/><label for="theme1">亲子</label>
						<input type="checkbox" class="productTheme" rId="2" rName="热门推荐" id="theme2"/><label for="theme2">户外</label>
    				</td>
                </tr>
    			<tr >
    				<td>*产品标签：</td>
                    <td>
						<input type="checkbox" class="productTag" rId="0" rName="亲子夏令营" id="tag0"/><label for="tag0">亲子夏令营</label>
						<input type="checkbox" class="productTag" rId="1" rName="蜜月之旅" id="tag1"/><label for="tag1">蜜月之旅</label>
    				</td>
                </tr>
    			<tr >
    				<td>*发布人：</td>
                    <td>
    					<span><input type="radio" value="0" name="publisherType" class="publisherType" checked><label for="publisherType1">怡美官方</label></span>
    					<span><input type="radio" value="1" name="publisherType" class="publisherType"><label for="publisherType2">旅游咖</label></span>
    					<span class="travel-ka-panel" style="display:none;">
    						<button class="btn btn-primary" id="selectTravelKa">请选择旅游咖</button>
    						<span class="travel-ka-content"></span>
						</span>
    				</td>
                </tr>
    			<tr >
    				<td>出发地：</td>
                    <td>
    					<select class="form-control from">
                            <option value="北京_1" selected>北京</option>
							<option value="南京_2">南京</option>
                         </select>
    				</td>
                </tr>
    			<tr >
    				<td>*目的地：</td>
                    <td>
    					<select class="form-control to">
                            <option value="大理_3" selected>大理</option>
							<option value="丽江_4">丽江</option>
                         </select>
    				</td>
    				</td>
                </tr>
    			<tr >
    				<td>*线路设计亮点：</td>
                    <td>
    					<textarea class="form-control highlights" rows="3" value="$!product.highlights"></textarea>
    				</td>
                </tr>
    			<tr >
    				<td>我为自己代言：</td>
                    <td>
    					<textarea class="form-control recommond" rows="3" value="$!product.recommond"></textarea>
    				</td>
                </tr>
            </table>
		</div>
		<div>
    		<div>报名须知</div>
			<div><button class="btn btn-default">增加条目</button></div>
        	<table>
				<thead >
            		<tr >
        				<th>标题（10个字以内）</th>
        				<th>内容（500字以内）</th>
                    </tr>
                </thead>
				<tbody >
            		<tr >
        				<td><input type="text" class="form-control" placeholder="费用包含"></td>
        				<td><textarea class="form-control" rows="3"></textarea></td>
						<td><button class="btn btn-link">删除</button></td>
                    </tr>
					<tr >
        				<td><input type="text" class="form-control" placeholder="费用包含"></td>
        				<td><textarea class="form-control" rows="3"></textarea></td>
						<td><button class="btn btn-link">删除</button></td>
                    </tr>
					<tr >
        				<td><input type="text" class="form-control" placeholder="费用包含"></td>
        				<td><textarea class="form-control" rows="3"></textarea></td>
						<td><button class="btn btn-link">删除</button></td>
                    </tr>
					<tr >
        				<td><input type="text" class="form-control" placeholder="费用包含"></td>
        				<td><textarea class="form-control" rows="3"></textarea></td>
						<td><button class="btn btn-link">删除</button></td>
                    </tr>
                </tbody>
            </table>
			<div>重要条款：<input type="text" class="form-control"><button class="btn btn-default">浏览</button></div>
		</div>
		<div><button class="btn btn-primary save">保存</button></div>
    </div>
	<script type="text/javascript">
		$(".publisherType").click(function() {
			if($(this).val()==1) {
				$(".travel-ka-panel").show();
			} else {
				$(".travel-ka-panel").hide();
			}
		});
	
		$("#selectTravelKa").click(function() {
			openModal('$!utilWebconfig.getActionDefaultFontPath()/trade/userManage/selectUserList','选择旅游咖', function(resultValue) {
				var id = resultValue[0].id;
				var name = resultValue[0].name;
				var span = $("<span class='label label-badge label-info travel-ka'>"+name+"</span>");
				span.attr("rId",id);
				span.attr("rName",name);
				var content = $(".travel-ka-content");
				content.empty();
				content.append(span);
			});
		});
		// 获取行程信息
		function getBaseInfo() {
			var type = $(".productType").val();
			var name = $(".productNme").val();
			var productImage = $(".productImage").val();
			var tripImage = $(".tripImage").val();
			var themes = [];
			$(".productTheme:checked").each(function(){
				var id = $(this).attr("rId");
				var name = $(this).attr("rName");
				themes.push({id:id,name:name});
			});
			var tags = [];
			$(".productTag:checked").each(function(){
				var id = $(this).attr("rId");
				var name = $(this).attr("rName");
				tags.push({id:id,name:name});
			});
			var publisherType = $(".publisherType:checked").val();
			var froms = [];
			var from_arr = $(".from").val().split("_");
			froms.push({id:from_arr[1],name:from_arr[0]});
			var tos = [];
			var to_arr = $(".to").val().split("_");
			tos.push({id:to_arr[1],name:to_arr[0]});
			var highlights = $(".highlights").val();
			var recommond = $(".recommond").val();
			var result = {
				type:type,
				name:name,
				productImage:productImage,
				tripImage:tripImage,
				themes:themes,
				tags:tags,
				publisherType:publisherType,
				froms:froms,
				tos:tos,
				highlights:highlights,
				recommond:recommond
			};
			if(publisherType!=0) {
				var travel_ka = $(".travel-ka");
				result["publisher"] = {id:travel_ka.attr("rId"),name:travel_ka.attr("rName")};
			}
			alert(JSON.stringify(result));
		}
		$(".save").click(getBaseInfo);
    </script>
</div>