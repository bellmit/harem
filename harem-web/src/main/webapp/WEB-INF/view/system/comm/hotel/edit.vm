<script src="$utilWebconfig.getStaticResourcesPath()/resources/js/layerModal.js"></script>
<script src="$utilWebconfig.getStaticResourcesPath()/resources/js/upload.js"></script>
<div class="example whole">
    <form name="commHotelForm" id="commHotelForm" action="" method="post" commHotelId="$!commHotel.id">
            <div class="">
                <table class="table">
                    <tbody>
                    <tr>
                        <td><span class="spColor">*</span>分类</td>
                        <td>
                            酒店
                        </td>
                    </tr>
                    <tr>
                        <td><span class="spColor">*</span>酒店</td>
                        <td>
                            <button type="button" class="btn btn-info selectHotelBtn">选择酒店</button>
                            <span class="hotelName">$!commHotel.subTitle</span>
                            <input class="hotelNameInp" type="hidden" name="subTitle" value="$!commHotel.subTitle" disabled>
                            <input class="hotelIdInp" type="hidden" name="outId" value="$!commHotel.outId" disabled>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="spColor">*</span>排序</td>
                        <td><input type="text" name="index" value="$!commHotel.index" disabled></td>
                    </tr>
                    <tr>
                        <td>*时间区间</td>
                        <td>用户可选入住时间为<input type="text" name="dateInterval" value="$!commHotel.dateInterval" disabled></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>商品名称</th>
                        <th>说明</th>
                        <th>单价</th>
                        <th>会员优惠额度</th>
                        <th>会员限购</th>
                        <th>图片</th>

                    </tr>
                    </thead>
                    <tbody>
                        <tr class="subCheckedTR">
                            <td><input type="text" name="title" value="$!commHotel.title"></td>
                            <td><input type="text" name="oneWord" value="$!commHotel.oneWord"></td>
                            <td><input type="text" name="price" value="$!commHotel.price"></td>
                            <td><input type="text" name="huiyuanyouhuiedu" value="$!commHotel.huiyuanyouhuiedu" disabled></td>
                            <td><input type="text" name="huiyuanxiangou" value="$!commHotel.huiyuanxiangou" disabled></td>
                            <td>
                                <input id="fileID" type="file" accept="image/png,image/gif">
                                <img class="picUrlImg" src="#if($!hotel.logoUrl)$utilWebconfig.getTfsRootPath()$!hotel.logoUrl #end">
                                <input class="picUrlVal" type="hidden" name="picUrls" value="$!commHotel.picUrls">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="clubBotBtn">
                <div class="btn-group">
                    <button class="btn btn-success" type="button" id="btnSubmit" >添加</button>
                </div>
                <div class="btn-group">
                    <button type="button"  class="btn closBtn">取消</button>
                </div>
            </div>
        <div class="">
            #if($!commHotel.id)
                <table class="table">
                    <tbody>
                    <tr>
                        <td>创建时间</td>
                        <td>
                            $!utilDate.dateToString($!commHotel.gmtCreated,"yyyy-MM-dd HH:mm:ss")
                        </td>
                    </tr>
                    <tr>
                        <td>更新时间</td>
                        <td>
                            $!utilDate.dateToString($!commHotel.gmtModified,"yyyy-MM-dd HH:mm:ss")
                        </td>
                    </tr>
                    </tbody>
                </table>
            #end
        </div>
    </form>
</div>
<script>
    var pictureUploadCallBack = function(data){
        if(data && data.status == 200){
            $('.picUrlVal').val(data.data);
            $('.picUrlImg').attr('src',tfsRootPath + data.data);

        }else{
            layer.msg('图片上传失败，请重试', {icon: 2});
        }
    }
    var selectUserCallBack = function(data){
        if(data){
            $('.hotelName').text(data['name']);
            $('.hotelNameInp').val(data['id']);
            $('.hotelNameInp').val(data['name']);
        }
    }
    $(function(){
        //上传图片
        $(document).delegate("#fileID",'change',function(){
            fileUpload('#fileID',1,pictureUploadCallBack);
        })
        //选择酒店
        $('.selectHotelBtn').click(function(){
            openModal(actionDefaultPath + '/B2C/hotelManage/selectList?multiSelect=1','选择酒店',selectUserCallBack);
        });
        //提交
        $('#btnSubmit').click(function(){
            $(this).prop('disabled',true);
            var actionUrl;
            var commHotelId = $('#commHotelForm').attr('commHotelId');
            if(commHotelId){
                actionUrl = actionDefaultPath + '/B2C/comm/hotelManage/edit/' + commHotelId;
            }else{
                actionUrl = actionDefaultPath + '/B2C/comm/hotelManage/add';
            }
            $('#commHotelForm').attr('action',actionUrl);
            $('#commHotelForm').submit();
        });

        $('.closBtn').click(function(){
            window.close();
        });

    });
</script>