<link href="$utilWebconfig.getStaticResourcesPath()/resources/zui/lib/datetimepicker/datetimepicker.min.css" rel="stylesheet">
<script src="$utilWebconfig.getStaticResourcesPath()/resources/zui/lib/datetimepicker/datetimepicker.min.js" type="text/javascript"></script>
    <div class="btn-group">
        <button type="button" class="btn btn-primary batchBtn">批量违规</button>
    </div>
    <form class="form-signin" id="trendListForm" name="trendListForm" action="$!utilWebconfig.getActionDefaultFontPath()/B2C/trendManage/list" method="GET" role="form">
        <div class="inputGroup whole">
            <div class="input-group inpSingle">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button">直播标签：</button>
                </span>
                <select class="form-control" name="tag">
                    <option value="0">全部</option>
                    <option value="1" #if($!trendListQuery.joinStatus == 1) selected #end>标签1</option>
                    <option value="2" #if($!trendListQuery.joinStatus == 2) selected #end>标签2</option>
                </select>
            </div>

            <div class="input-group inpSingle">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">发布时间：</button>
                    </span>
                <input type="text" class='form-control form-date' placeholder='开始日期：yyyy-MM-dd' readonly name="beginDate" value="$!trendListQuery.beginDate">
                <span class="input-group-addon fix-border fix-padding">至</span>
                <input type="text" class='form-control form-date' placeholder='结束日期：yyyy-MM-dd' readonly name="endDate" value="$!trendListQuery.endDate">
            </div>

            <div class="input-group inpSingle">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button">状态：</button>
                </span>
                <select class="form-control" name="trendStatus">
                    <option value="1" #if($!trendListQuery.trendStatus == 1) selected #end>正常</option>
                    <option value="2" #if($!trendListQuery.trendStatus == 2) selected #end>违规</option>
                </select>
            </div>

            <div class="input-group inpSingle">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">用户手机号</button>
                    </span>
                <input type="text" class="form-control" name="userTel" value="$!trendListQuery.userTel">
            </div>

            <div class="input-group inpSingle">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">用户昵称</button>
                    </span>
                <input type="text" class="form-control" name="userName" value="$!trendListQuery.userName">
            </div>
            <div class="btn-group">
                <button type="submit" class="btn btn-primary">查询</button>
            </div>
            <div class="btn-group">
                <button type="reset" class="btn btn-primary">重置</button>
            </div>
        </div>

        <div class="tableGroup whole">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th><input class="allChecked" name="allChecked" type="checkbox">全选</th>
                    <th>用户昵称</th>
                    <th>用户手机号</th>
                    <th>内容</th>
                    <th>点赞数</th>
                    <th>评论数</th>
                    <th>状态</th>
                    <th>发布时间</th>
                    <th>操作</th>

                </tr>
                </thead>
                <tbody>
                    #foreach($trend in $trendList)
                    <tr class="subCheckedTR">
                        <td><input class="subChecked" type="checkbox" value="$!trend.id"></td>
                        <td>$!trend.user.name</td>
                        <td>$!trend.user.tel</td>
                        <td>$!trend.content</td>
                        <td>$!trend.praiseNum</td>
                        <td>$!trend.commentNum</td>
                        <td>#TREND_STATUS($!trend.trendStatus)</td>
                        <td>$!utilDate.dateToString($!trend.publishDate,"yyyy-MM-dd HH:mm:ss")</td>
                        <td>
                            <button type="button" class="btn btn-primary trendDetail" trendId="$trend.id">详情</button>
                            <button type="button" class="btn btn-primary trendBan"  trendId="$trend.id" >图片</button>
                        </td>
                    </tr>
                    #end
                </tbody>
            </table>
        </div>
    #*分页*#
    #parse("/page.vm")
    #pageStyle("trendListForm")
    </form>
<script>
    $(".form-date").datetimepicker(
            {
                language:  "zh-CN",
                weekStart: 1,
                todayBtn:  1,
                autoclose: 1,
                todayHighlight: 1,
                startView: 2,
                minView: 2,
                forceParse: 0,
                format: "yyyy-mm-dd"
            });
    function openwin(url) {
        var a = document.createElement("a");
        a.setAttribute("href", url);
        a.setAttribute("target", "_blank");
        a.setAttribute("id", "camnpr");
        document.body.appendChild(a);
        a.click();
    }
    $(function(){
        //详情
        $('.trendDetail').each(function(){
            $(this).click(function(){
                var url = '$!utilWebconfig.getActionDefaultFontPath()' + '/B2C/trendManage/'+ $(this).attr('trendId');
                window.openwin(url);
            });

        });
        //全选
        $('.allChecked').click(function(){
            $('.subChecked').prop('checked',$(this).prop('checked'));
        });
        //单选
        $('.subCheckedTR').click(function(){
            $(this).find('.subChecked').prop('checked',!$(this).find('.subChecked').prop('checked'));
        });
        //批量违规
        $('.batchBtn').click(function(){
            var arr = new Array();
            $('.subChecked:checked').each(function(){
                arr.push($(this).val());
            });
            console.log(arr);

            $.post('$!utilWebconfig.getActionDefaultFontPath()/B2C/trendManage/setTrendStatusList',{trendStatusList:arr},function(data){
                if(data&&data.status == 200){
                    layer.alert('操作成功');
                }else{
                    layer.alert("失败");
                }
            })
        });
    });
</script>