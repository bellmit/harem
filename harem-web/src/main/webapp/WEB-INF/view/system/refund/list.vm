<link href="$!{rc.contextPath}/resources/zui/lib/datetimepicker/datetimepicker.min.css" rel="stylesheet">
<script src="$!{rc.contextPath}/resources/zui/lib/datetimepicker/datetimepicker.min.js" type="text/javascript"></script>
<link rel="stylesheet" href="/resources/css/common.css"/>
<h1>退款</h1>
<div>
    <form class="form-signin" id="refundListForm" name="refundListForm" action="/refundManage/list" method="GET" role="form">
        <div class="inputGroup whole">
            <div class="input-group inpSingle">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">交易号</button>
                    </span>
                <input type="text" class="form-control" name="tradeId" value="$!refundListQuery.refundNO">
            </div>
            <div class="input-group inpSingle">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">交易时间</button>
                    </span>
                <input type="text" class='form-control form-date startDate' placeholder='开始日期：yyyy-MM-dd' readonly name="beginDate" value="$!refundListQuery.beginDate">
                <span class="input-group-addon fix-border fix-padding">至</span>
                <input type="text" class='form-control form-date' placeholder='结束日期：yyyy-MM-dd' readonly name="endDate" value="$!refundListQuery.endDate">
            </div>

            <div class="btn-group">
                <button type="submit" class="btn btn-primary">查询</button>
            </div>
            <div class="btn-group">
                <button type="button" class="btn">导出</button>
            </div>
        </div>

        <div class="tableGroup whole">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>交易编号</th>
                    <th>部门</th>
                    <th>工号</th>
                    <th>终端编号</th>
                    <th>支付方式</th>
                    <th>实际退款金额</th>
                    <th>付款金额</th>
                    <th>使用积分</th>
                    <th>赠送积分</th>
                    <th>交易时间</th>
                    <th>小票时间</th>
                    <th>查看</th>
                </tr>
                </thead>
                <tbody>
                    #foreach($refund in $refundList)
                    <tr>
                        <td>$!velocityCount</td>
                        <td>$!refund.tradeId</td>
                        <td>$!refund.department</td>
                        <td>$!refund.jobNumber</td>
                        <td>$!refund.terminalNumber</td>
                        <td>#PAY_STATUS($!refund.payment)</td>
                        <td>$!utilNum.moneyTransform($!refund.refundPayment)</td>
                        <td>$!utilNum.moneyTransform($!refund.refundPayment)</td>
                        <td>$!refund.shouldRefundPoint</td>
                        <td>$!refund.availablePoint</td>
                        <td>$!utilDate.dateToString($!refund.refundTime,"yyyy-MM-dd HH:mm:ss")</td>
                        <td>$!utilDate.dateToString($!refund.receiptTime,"yyyy-MM-dd HH:mm:ss")</td>
                        <td><a href="javascript:void(0);" class="getOrderDetail">订单详情</a></td>
                    </tr>
                    #end
                </tbody>
            </table>
        </div>

    #*分页*#
    #parse("/page.vm")
    #pageStyle("refundListForm")
    </form>
</div>
<script>
    $("#refundListForm").validate({
        rules:{
            tradeId:{
                number:true
            },
            endDate:{
                compareDate:".startDate"
            }
        },
        messages:{
            tradeId:{
                number:"请输入正确的交易号"
            },
            endDate:{
                compareDate:"结束日期必须大于开始日期!"
            }
        },
        errorPlacement: function(error, element) {
            element.parent().parent().append (error);
        }
    })


    $(".form-date").datetimepicker(
            {
                language:  "zh-CN",
                weekStart: 1,
                todayBtn:  1,
                autoclose: 1,
                todayHighlight: 1,
                startView: 2,
                minView: 2,
                forceParse: 0,
                format: "yyyy-mm-dd"
            });
    $(function(){
        $('.getOrderDetail').click(function(){
            window.open("/refundManage/"+id, "_blank");
        });
    });

    $("#refundListForm").validate({
        rules:{
            refundNO:"required"
        }
    })

</script>
