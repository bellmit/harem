<link rel="stylesheet" href="$utilWebconfig.getStaticResourcesPath()/resources/css/common.css"/>
<link rel="stylesheet" href="$utilWebconfig.getStaticResourcesPath()/resources/css/clubTable.css"/>
<script src="$utilWebconfig.getStaticResourcesPath()/resources/js/layerModal.js" type="text/javascript"></script>
<script src="$utilWebconfig.getStaticResourcesPath()/resources/js/upload.js"></script>
<div class="createClubTable whole">
    <form name="addClub" id="clubForm" action="" method="post" clubId="$!club.id">
        <table class="table">
            <tr>
                <td><span class="spColor">*</span>俱乐部名称</td>
            
                <td><input type="text" class="form-control" placeholder="请输入20个字以内" name="clubName" value="$!club.clubName"></td>
            </tr>
            <tr>
                <td><span class="spColor">*</span>俱乐部LOGO</td>
                <td>
                    <div class="fileImgWrap">
                        <button type="button" class="btn btn-success">选择图片</button>
                        <input type="file" name="file" class="fileInp" id="logoUrlUploadFile">
                        <input type="hidden" name="logoUrl" value="$!club.logoUrl" id="logoUrlUploadFileReturnInput" >
                        <p>注：图片大小不超过5M<br />建议尺寸：300*300</p>
                    </div>
                    <div class="logoView">
                        <img src="#if($club.logoUrl) $utilWebconfig.getTfsRootPath()$!club.logoUrl #end" class="img-circle" id="logoUrlUploadFileReturnImg">
                    </div>
                </td>
            </tr>
            <tr>
                <td><span class="spColor">*</span>俱乐部宣传图</td>
                <td>
                    <div class="fileImgWrap">
                        <button type="button" class="btn btn-success">选择图片</button>
                        <input type="file"  name="file" class="fileInp" id="picturePosterUploadFile" accept="image/png,image/gif">
						<input type="hidden" name="backImg" value="$!club.backImg"  id="picturePosterUploadFileReturnInput">
							
                        <p>注：图片大小不超过5M<br />建议尺寸：687*237</p>
                    </div>
                    <div class="propagandaView">
                        <img src="#if($club.backImg) $utilWebconfig.getTfsRootPath()$!club.backImg  #end" id="picturePosterUploadFileReturnImg">
                    </div>
                </td>
            </tr>
           #*
           	 <tr>
                <td><span class="spColor">*</span>成员限额</td>
                <td><input type="text" class="form-control" placeholder="请输入数字" name="memberCount" value="$!club.memberCount"></td>
            </tr>
           *#
            <tr>
                <td><span class="spColor">*</span>部长</td>
                <td>
                    <div class="userBtn">
                        <button type="button" class="btn btn-info selectUserBtn">选择用户</button>
                        <input type="hidden" name="manageUserName" value="$!club.manageUserName">
                        <input type="hidden" name="manageUserLogoUrl" value="$!club.manageUserLogoUrl">
                    </div>
                    <div class="userView">
                        <img src=" #if($club.manageUserLogoUrl) $utilWebconfig.getTfsRootPath()$!club.manageUserLogoUrl  #end">
                        #*TODO*#
                        <span class="userNameShow">Tracy</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td><span class="spColor">*</span>排序</td>
                <td><input type="text" class="form-control" placeholder="请输入数字，数字越大排序靠后" name="score" value="$!club.score"></td>
            </tr>
            #*
            	<tr>
	                <td><span class="spColor">*</span>状态</td>
	                <td class="radioSel">
	                    <div class="col-md-10">
	                        <label class="radio-inline"> <input type="radio" name="joinStatus" value="1" #if($!club.joinStatus == 1) checked #end> 允许加入 </label>
	                        <label class="radio-inline"> <input type="radio" name="joinStatus" value="0" #if($!club.joinStatus == 2) checked #end> 禁止加入 </label>
	                    </div>
	                </td>
            	</tr>
            *#
            <tr>
                <td><span class="spColor">*</span>前台显示</td>
                <td class="radioSel">
                    <div class="col-md-10">
                        <label class="radio-inline"> <input type="radio" name="state" value="1" #if($!club.showStatus == 1) checked #end> 显示 </label>
                        <label class="radio-inline"> <input type="radio" name="state" value="0" #if($!club.showStatus == 2) checked #end> 隐藏 </label>
                    </div>
                </td>
            </tr>
        </table>
        <div class="clubBotBtn">
            <div class="btn-group">
                <button class="btn btn-success" type="button" id="btnSubmit" >添加</button>
            </div>
            <div class="btn-group">
                <button class="btn">取消</button>
            </div>
        </div>
    </form>
</div>
<script>
    var selectUserCallBack = function(data){
        if(data){
            $('.userNameShow').text(data[0].name);
        }
    }
	
	var pictureUploadCallBack = function(data){
        if(data && data.status == 200){
		    console.log(data.data);
            $('#picturePosterUploadFileReturnInput').val(data.data);
            $('#picturePosterUploadFileReturnImg').attr('src',tfsRootPath + data.data);

        }else{
            layer.msg('图片上传失败，请重试', {icon: 2});
        }
    }
	
		var LogoPicloadCallBack = function(data){
        if(data && data.status == 200){
		    console.log(data.data);
            $('#logoUrlUploadFileReturnInput').val(data.data);
            $('#logoUrlUploadFileReturnImg').attr('src',tfsRootPath + data.data);

        }else{
            layer.msg('图片上传失败，请重试', {icon: 2});
        }
    }
	
    $(function(){
        $('.selectUserBtn').click(function(){
            '$!utilWebconfig.getActionDefaultFontPath()',
                    openModal(actionDefaultPath + '/trade/userManage/selectUserList', "选择用户", selectUserCallBack)
        })

		 //上传图片
        $(document).delegate("#picturePosterUploadFile",'change',function(){
            fileUpload('#picturePosterUploadFile',1,pictureUploadCallBack);
        })
		
		 //上传图片
        $(document).delegate("#logoUrlUploadFile",'change',function(){
            fileUpload('#logoUrlUploadFile',1,LogoPicloadCallBack);
        })
		
		


        $('#btnSubmit').click(function(){
            $(this).prop('disabled',true);
            var actionUrl;
            var clubId = $('#clubForm').attr('clubId');
            if(clubId){
                actionUrl = '/B2C/clubManage/edit/'+clubId;
            }else{
                actionUrl = '/B2C/clubManage/add';
            }
            
            $('#clubForm').attr('action',actionUrl);
			$('#clubForm').submit();
           #* 
			$.post(actionUrl,$('#clubForm').serialize(),function(data){
                if(data.status == 200){
                    var msg = new $.zui.Messager('操作成功', {placement: 'center',type:'success',time:'1000'});
                    msg.show();
                    setTimeout(function(){
                        window.close();
                    },1050);
                }else{
                    var msg = new $.zui.Messager('操作失败', {placement: 'center',type:'warning',time:'1000'});
                    msg.show();
                    $(this).prop('disabled',false);
                }
            });
			*#
        });
    });
</script>